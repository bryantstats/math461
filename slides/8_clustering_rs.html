<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Clustering and Recommendation System</title>
    <meta charset="utf-8" />
    <meta name="author" content=" Son Nguyen " />
    <script src="libs/header-attrs-2.23/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/metropolis-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
    <script src="libs/d3-bundle-5.16.0/d3-bundle.min.js"></script>
    <script src="libs/d3-lasso-0.0.5/d3-lasso.min.js"></script>
    <script src="libs/save-svg-as-png-1.4.17/save-svg-as-png.min.js"></script>
    <script src="libs/flatbush-4.0.0/flatbush.min.js"></script>
    <link href="libs/ggiraphjs-0.4.6/ggiraphjs.min.css" rel="stylesheet" />
    <script src="libs/ggiraphjs-0.4.6/ggiraphjs.min.js"></script>
    <script src="libs/girafe-binding-0.8.7/girafe.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Clustering and Recommendation System
]
.author[
### <font size="5"> Son Nguyen </font>
]

---


&lt;style&gt;

.remark-slide-content {
  background-color: #FFFFFF;
  border-top: 80px solid #F9C389;
  font-size: 17px;
  font-weight: 300;
  line-height: 1.5;
  padding: 1em 2em 1em 2em
}

.inverse {
  background-color: #696767;
  border-top: 80px solid #696767;
  text-shadow: none;
  background-image: url(https://github.com/goodekat/presentations/blob/master/2019-isugg-gganimate-spooky/figures/spider.png?raw=true);
	background-position: 50% 75%;
  background-size: 150px;
}

.your-turn{
  background-color: #8C7E95;
  border-top: 80px solid #F9C389;
  text-shadow: none;
  background-image: url(https://github.com/goodekat/presentations/blob/master/2019-isugg-gganimate-spooky/figures/spider.png?raw=true);
	background-position: 95% 90%;
  background-size: 75px;
}

.title-slide {
  background-color: #F9C389;
  border-top: 80px solid #F9C389;
  background-image: none;
}

.title-slide &gt; h1  {
  color: #111111;
  font-size: 40px;
  text-shadow: none;
  font-weight: 400;
  text-align: left;
  margin-left: 15px;
  padding-top: 80px;
}
.title-slide &gt; h2  {
  margin-top: -25px;
  padding-bottom: -20px;
  color: #111111;
  text-shadow: none;
  font-weight: 300;
  font-size: 35px;
  text-align: left;
  margin-left: 15px;
}
.title-slide &gt; h3  {
  color: #111111;
  text-shadow: none;
  font-weight: 300;
  font-size: 25px;
  text-align: left;
  margin-left: 15px;
  margin-bottom: -30px;
}

&lt;/style&gt;

&lt;style type="text/css"&gt;
.left-code {
  color: #777;
  width: 48%;
  height: 92%;
  float: left;
}
.right-plot {
  width: 51%;
  float: right;
  padding-left: 1%;
}
&lt;/style&gt;



# Dataset

We study a Spotify dataset conataining information about songs. 

The dataset can be downloaded at [this link.](SpotifyFeatures.csv)

Let's import the data. 


```r
library(tidyverse)
library(factoextra)
library(dplyr)
library(GGally)
library(inspectdf)
library(ggiraphExtra)
library(factoextra)
library(tidyr)

df_original = read_csv("SpotifyFeatures.csv")
```


---
# Data Exploration

&lt;img src="8_clustering_rs_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;

---
# Data Exploration

&lt;img src="8_clustering_rs_files/figure-html/unnamed-chunk-4-1.png" style="display: block; margin: auto;" /&gt;

---
# Data Exploration

&lt;img src="8_clustering_rs_files/figure-html/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /&gt;

---
# Data Exploration


```r
# Select only numeric variables
df = df_original %&gt;%
  select(where(is.numeric))
# scale the data
df &lt;- data.frame((scale(df)))
# plot the correlation matrix
ggcorr(df, label=T, label_size = 2.9, hjust = 1)
```

&lt;img src="8_clustering_rs_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;


---
# WSS


```r
# Define the range of clusters you want to consider
num_clusters &lt;- 2:7

# Calculate WSS for each number of clusters
wss &lt;- numeric(length(num_clusters))
for (i in seq_along(num_clusters)) {
  k &lt;- num_clusters[i]
  kmeans_model &lt;- kmeans(df, centers = k, nstart = 10)
  wss[i] &lt;- kmeans_model$tot.withinss
}

# Plot the WSS values against the number of clusters
plot(num_clusters, wss, type = "b", pch = 19, frame = FALSE,
     xlab = "Number of Clusters", ylab = "Within-Cluster Sum of Squares")

# Add a vertical line at the "elbow point"
elbow_point &lt;- which(diff(wss) &lt;= 0.01 * max(diff(wss)))
abline(v = num_clusters[elbow_point], col = "red")
```


---
# WSS

&lt;img src="8_clustering_rs_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /&gt;


---
# k-means Clustering


```r
# Apply k-means
k &lt;- kmeans(df, centers = 3)
df1 = df
df1$cluster = factor(k$cluster)
```

---
# Plot the radar


```r
# plot the radar
library(ggiraphExtra)
ggRadar(
  data=df1,
  mapping = aes(colours = cluster),
  interactive = T
)
```

<div class="girafe html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5e152ca88f9f842a69ad" style="width:720px;height:360px;"></div>
<script type="application/json" data-for="htmlwidget-5e152ca88f9f842a69ad">{"x":{"html":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='ggiraph-svg' role='img' id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c' viewBox='0 0 720 360'>\n <defs id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_defs'>\n  <clipPath id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_c1'>\n   <rect x='0' y='0' width='720' height='360'/>\n  <\/clipPath>\n  <clipPath id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_c2'>\n   <rect x='194.4' y='0' width='331.19' height='360'/>\n  <\/clipPath>\n  <clipPath id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_c3'>\n   <rect x='229.99' y='44.68' width='290.13' height='290.13'/>\n  <\/clipPath>\n <\/defs>\n <g id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_rootg' class='ggiraph-svg-rootg'>\n  <g clip-path='url(#svg_20e0781b_0982_4ede_ac97_71ce36a6226c_c1)'>\n   <rect x='0' y='0' width='720' height='360' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.75' stroke-linejoin='round' stroke-linecap='round' class='ggiraph-svg-bg'/>\n  <\/g>\n  <g clip-path='url(#svg_20e0781b_0982_4ede_ac97_71ce36a6226c_c2)'>\n   <rect x='194.4' y='0' width='331.19' height='360' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='round'/>\n  <\/g>\n  <g clip-path='url(#svg_20e0781b_0982_4ede_ac97_71ce36a6226c_c3)'>\n   <rect x='229.99' y='44.68' width='290.13' height='290.13' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\n   <polyline points='375.05,189.74 411.84,64.47' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,189.74 473.72,104.24' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,189.74 504.28,171.16' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,189.74 493.81,243.98' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,189.74 445.64,299.57' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,189.74 375.05,320.30' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,189.74 304.47,299.57' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,189.74 256.29,243.98' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,189.74 245.83,171.16' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,189.74 276.38,104.24' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,189.74 338.27,64.47' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,163.91 376.69,163.96 378.32,164.12 379.94,164.38 381.54,164.74 383.11,165.20 384.65,165.76 386.15,166.42 387.61,167.17 389.02,168.01 390.37,168.94 391.66,169.95 392.88,171.05 394.03,172.22 395.10,173.45 396.09,174.76 397.00,176.12 397.82,177.54 398.55,179.01 399.18,180.52 399.72,182.07 400.15,183.65 400.49,185.26 400.72,186.88 400.85,188.51 400.88,190.15 400.80,191.79 400.62,193.42 400.33,195.03 399.95,196.62 399.46,198.19 398.88,199.72 398.20,201.21 397.42,202.65 396.56,204.05 395.61,205.38 394.57,206.65 393.46,207.86 392.27,208.99 391.02,210.04 389.70,211.01 388.32,211.90 386.89,212.70 385.41,213.40 383.89,214.01 382.33,214.52 380.74,214.93 379.13,215.24 377.51,215.45 375.87,215.56 374.23,215.56 372.60,215.45 370.97,215.24 369.36,214.93 367.78,214.52 366.22,214.01 364.70,213.40 363.22,212.70 361.79,211.90 360.41,211.01 359.09,210.04 357.83,208.99 356.65,207.86 355.53,206.65 354.50,205.38 353.55,204.05 352.69,202.65 351.91,201.21 351.23,199.72 350.65,198.19 350.16,196.62 349.77,195.03 349.49,193.42 349.31,191.79 349.23,190.15 349.25,188.51 349.38,186.88 349.62,185.26 349.95,183.65 350.39,182.07 350.93,180.52 351.56,179.01 352.29,177.54 353.11,176.12 354.01,174.76 355.01,173.45 356.08,172.22 357.23,171.05 358.45,169.95 359.74,168.94 361.09,168.01 362.50,167.17 363.95,166.42 365.45,165.76 366.99,165.20 368.57,164.74 370.17,164.38 371.78,164.12 373.42,163.96 375.05,163.91' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,137.90 378.34,138.00 381.62,138.32 384.86,138.84 388.07,139.56 391.23,140.49 394.32,141.61 397.33,142.93 400.26,144.44 403.08,146.13 405.79,147.99 408.38,150.03 410.83,152.22 413.14,154.57 415.29,157.05 417.28,159.67 419.10,162.41 420.75,165.26 422.21,168.20 423.48,171.24 424.56,174.35 425.43,177.52 426.11,180.74 426.58,183.99 426.84,187.27 426.89,190.56 426.73,193.85 426.37,197.12 425.80,200.36 425.02,203.55 424.04,206.70 422.87,209.77 421.50,212.76 419.95,215.66 418.21,218.46 416.31,221.14 414.23,223.69 412.00,226.11 409.62,228.38 407.10,230.49 404.45,232.44 401.68,234.22 398.81,235.82 395.84,237.23 392.78,238.46 389.66,239.48 386.47,240.31 383.24,240.93 379.98,241.35 376.70,241.56 373.41,241.56 370.13,241.35 366.86,240.93 363.63,240.31 360.45,239.48 357.32,238.46 354.27,237.23 351.30,235.82 348.42,234.22 345.66,232.44 343.01,230.49 340.49,228.38 338.11,226.11 335.87,223.69 333.80,221.14 331.89,218.46 330.16,215.66 328.60,212.76 327.24,209.77 326.06,206.70 325.09,203.55 324.31,200.36 323.74,197.12 323.38,193.85 323.22,190.56 323.27,187.27 323.53,183.99 324.00,180.74 324.67,177.52 325.55,174.35 326.63,171.24 327.90,168.20 329.36,165.26 331.00,162.41 332.82,159.67 334.82,157.05 336.97,154.57 339.28,152.22 341.73,150.03 344.32,147.99 347.03,146.13 349.85,144.44 352.77,142.93 355.79,141.61 358.88,140.49 362.03,139.56 365.24,138.84 368.49,138.32 371.77,138.00 375.05,137.90' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,111.89 379.99,112.04 384.91,112.51 389.79,113.29 394.61,114.38 399.35,115.77 403.99,117.46 408.51,119.44 412.91,121.71 417.14,124.25 421.21,127.05 425.10,130.10 428.78,133.39 432.24,136.92 435.48,140.65 438.47,144.58 441.21,148.69 443.68,152.97 445.87,157.40 447.78,161.96 449.40,166.62 450.71,171.39 451.72,176.22 452.43,181.11 452.82,186.04 452.90,190.98 452.66,195.91 452.11,200.82 451.26,205.69 450.09,210.49 448.63,215.20 446.86,219.82 444.81,224.31 442.48,228.67 439.87,232.87 437.01,236.89 433.89,240.72 430.54,244.35 426.96,247.76 423.18,250.94 419.20,253.87 415.05,256.54 410.73,258.94 406.27,261.06 401.68,262.90 396.99,264.44 392.21,265.68 387.35,266.62 382.45,267.24 377.52,267.56 372.58,267.56 367.65,267.24 362.75,266.62 357.90,265.68 353.12,264.44 348.43,262.90 343.84,261.06 339.38,258.94 335.06,256.54 330.91,253.87 326.93,250.94 323.14,247.76 319.57,244.35 316.21,240.72 313.10,236.89 310.23,232.87 307.63,228.67 305.30,224.31 303.24,219.82 301.48,215.20 300.01,210.49 298.85,205.69 297.99,200.82 297.44,195.91 297.21,190.98 297.29,186.04 297.68,181.11 298.38,176.22 299.39,171.39 300.71,166.62 302.33,161.96 304.23,157.40 306.43,152.97 308.90,148.69 311.64,144.58 314.63,140.65 317.86,136.92 321.33,133.39 325.01,130.10 328.89,127.05 332.96,124.25 337.20,121.71 341.59,119.44 346.12,117.46 350.76,115.77 355.50,114.38 360.32,113.29 365.20,112.51 370.12,112.04 375.05,111.89' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,85.87 381.64,86.08 388.20,86.71 394.71,87.75 401.14,89.20 407.46,91.06 413.66,93.31 419.69,95.96 425.55,98.98 431.21,102.36 436.64,106.10 441.82,110.17 446.73,114.57 451.35,119.27 455.67,124.25 459.66,129.49 463.31,134.98 466.61,140.69 469.53,146.59 472.08,152.67 474.24,158.90 475.99,165.25 477.34,171.70 478.28,178.23 478.80,184.80 478.91,191.39 478.59,197.97 477.86,204.52 476.72,211.01 475.16,217.42 473.21,223.71 470.86,229.87 468.12,235.86 465.00,241.67 461.53,247.27 457.71,252.64 453.55,257.76 449.08,262.60 444.31,267.15 439.26,271.39 433.95,275.29 428.41,278.86 422.65,282.06 416.70,284.89 410.58,287.34 404.32,289.40 397.94,291.06 391.46,292.30 384.93,293.14 378.35,293.56 371.76,293.56 365.18,293.14 358.64,292.30 352.17,291.06 345.79,289.40 339.53,287.34 333.41,284.89 327.46,282.06 321.70,278.86 316.15,275.29 310.85,271.39 305.80,267.15 301.03,262.60 296.56,257.76 292.40,252.64 288.58,247.27 285.10,241.67 281.99,235.86 279.25,229.87 276.90,223.71 274.94,217.42 273.39,211.01 272.24,204.52 271.51,197.97 271.20,191.39 271.30,184.80 271.83,178.23 272.76,171.70 274.11,165.25 275.87,158.90 278.03,152.67 280.57,146.59 283.50,140.69 286.79,134.98 290.45,129.49 294.44,124.25 298.75,119.27 303.38,114.57 308.29,110.17 313.47,106.10 318.90,102.36 324.55,98.98 330.41,95.96 336.45,93.31 342.64,91.06 348.97,89.20 355.40,87.75 361.90,86.71 368.47,86.08 375.05,85.87' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='375.05,59.18 383.33,59.45 391.58,60.23 399.76,61.54 407.84,63.37 415.79,65.70 423.58,68.54 431.17,71.86 438.53,75.65 445.64,79.91 452.46,84.61 458.97,89.73 465.15,95.25 470.96,101.16 476.38,107.42 481.40,114.01 485.99,120.91 490.13,128.08 493.81,135.51 497.01,143.15 499.72,150.98 501.93,158.96 503.63,167.07 504.81,175.27 505.46,183.53 505.59,191.81 505.20,200.09 504.28,208.32 502.84,216.48 500.89,224.53 498.43,232.44 495.47,240.18 492.03,247.72 488.12,255.02 483.75,262.06 478.95,268.81 473.72,275.24 468.10,281.32 462.10,287.04 455.76,292.37 449.09,297.28 442.12,301.76 434.88,305.78 427.40,309.34 419.71,312.42 411.84,315.01 403.82,317.09 395.68,318.66 387.46,319.71 379.20,320.23 370.91,320.23 362.64,319.71 354.43,318.66 346.29,317.09 338.27,315.01 330.40,312.42 322.71,309.34 315.23,305.78 307.99,301.76 301.02,297.28 294.35,292.37 288.00,287.04 282.01,281.32 276.38,275.24 271.16,268.81 266.36,262.06 261.99,255.02 258.08,247.72 254.63,240.18 251.68,232.44 249.22,224.53 247.26,216.48 245.83,208.32 244.91,200.09 244.51,191.81 244.64,183.53 245.30,175.27 246.48,167.07 248.18,158.96 250.38,150.98 253.09,143.15 256.29,135.51 259.97,128.08 264.12,120.91 268.70,114.01 273.72,107.42 279.15,101.16 284.96,95.25 291.13,89.73 297.64,84.61 304.47,79.91 311.58,75.65 318.94,71.86 326.53,68.54 334.32,65.70 342.26,63.37 350.35,61.54 358.53,60.23 366.77,59.45 375.05,59.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polygon id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e1' points='382.59,164.07 452.73,122.44 444.64,179.74 379.77,191.89 421.35,261.78 375.05,189.74 324.25,268.79 290.07,228.55 260.18,173.22 343.71,162.58 359.84,137.92' fill='#F8766D' fill-opacity='0.3' stroke='#F8766D' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='cluster=1'/>\n   <polygon id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e2' points='385.73,153.39 456.45,119.21 417.47,183.64 379.80,191.91 389.74,212.59 375.05,248.29 364.08,206.81 301.95,223.13 371.31,189.20 340.11,159.46 366.99,162.27' fill='#00BA38' fill-opacity='0.3' stroke='#00BA38' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='cluster=2'/>\n   <polygon id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e3' points='391.85,132.53 395.00,172.46 451.48,178.75 379.50,191.77 422.51,263.59 375.05,198.00 361.71,210.51 279.44,233.41 365.08,188.31 332.67,153.01 355.74,123.98' fill='#619CFF' fill-opacity='0.3' stroke='#619CFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='cluster=3'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e4' cx='382.59' cy='164.07' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='1' title='cluster=1&amp;lt;br&amp;gt;popularity=0.2'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e5' cx='452.73' cy='122.44' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='2' title='cluster=1&amp;lt;br&amp;gt;acousticness=0.8'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e6' cx='444.64' cy='179.74' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='3' title='cluster=1&amp;lt;br&amp;gt;danceability=0.5'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e7' cx='379.77' cy='191.89' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='4' title='cluster=1&amp;lt;br&amp;gt;duration_ms=0'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e8' cx='421.35' cy='261.78' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='5' title='cluster=1&amp;lt;br&amp;gt;energy=0.7'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e9' cx='375.05' cy='189.74' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='6' title='cluster=1&amp;lt;br&amp;gt;instrumentalness=0'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e10' cx='324.25' cy='268.79' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='7' title='cluster=1&amp;lt;br&amp;gt;liveness=0.7'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e11' cx='290.07' cy='228.55' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='8' title='cluster=1&amp;lt;br&amp;gt;loudness=0.7'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e12' cx='260.18' cy='173.22' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='9' title='cluster=1&amp;lt;br&amp;gt;speechiness=0.9'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e13' cx='343.71' cy='162.58' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='10' title='cluster=1&amp;lt;br&amp;gt;tempo=0.3'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e14' cx='359.84' cy='137.92' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='11' title='cluster=1&amp;lt;br&amp;gt;valence=0.4'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e15' cx='385.73' cy='153.39' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='12' title='cluster=2&amp;lt;br&amp;gt;popularity=0.3'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e16' cx='456.45' cy='119.21' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='13' title='cluster=2&amp;lt;br&amp;gt;acousticness=0.8'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e17' cx='417.47' cy='183.64' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='14' title='cluster=2&amp;lt;br&amp;gt;danceability=0.3'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e18' cx='379.8' cy='191.91' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='15' title='cluster=2&amp;lt;br&amp;gt;duration_ms=0'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e19' cx='389.74' cy='212.59' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='16' title='cluster=2&amp;lt;br&amp;gt;energy=0.2'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e20' cx='375.05' cy='248.29' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='17' title='cluster=2&amp;lt;br&amp;gt;instrumentalness=0.5'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e21' cx='364.08' cy='206.81' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='18' title='cluster=2&amp;lt;br&amp;gt;liveness=0.2'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e22' cx='301.95' cy='223.13' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='19' title='cluster=2&amp;lt;br&amp;gt;loudness=0.6'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e23' cx='371.31' cy='189.2' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='20' title='cluster=2&amp;lt;br&amp;gt;speechiness=0'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e24' cx='340.11' cy='159.46' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='21' title='cluster=2&amp;lt;br&amp;gt;tempo=0.4'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e25' cx='366.99' cy='162.27' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='22' title='cluster=2&amp;lt;br&amp;gt;valence=0.2'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e26' cx='391.85' cy='132.53' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='23' title='cluster=3&amp;lt;br&amp;gt;popularity=0.5'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e27' cx='395' cy='172.46' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='24' title='cluster=3&amp;lt;br&amp;gt;acousticness=0.2'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e28' cx='451.48' cy='178.75' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='25' title='cluster=3&amp;lt;br&amp;gt;danceability=0.6'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e29' cx='379.5' cy='191.77' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='26' title='cluster=3&amp;lt;br&amp;gt;duration_ms=0'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e30' cx='422.51' cy='263.59' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='27' title='cluster=3&amp;lt;br&amp;gt;energy=0.7'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e31' cx='375.05' cy='198' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='28' title='cluster=3&amp;lt;br&amp;gt;instrumentalness=0.1'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e32' cx='361.71' cy='210.51' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='29' title='cluster=3&amp;lt;br&amp;gt;liveness=0.2'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e33' cx='279.44' cy='233.41' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='30' title='cluster=3&amp;lt;br&amp;gt;loudness=0.8'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e34' cx='365.08' cy='188.31' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='31' title='cluster=3&amp;lt;br&amp;gt;speechiness=0.1'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e35' cx='332.67' cy='153.01' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='32' title='cluster=3&amp;lt;br&amp;gt;tempo=0.4'/>\n   <circle id='svg_20e0781b_0982_4ede_ac97_71ce36a6226c_e36' cx='355.74' cy='123.98' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='33' title='cluster=3&amp;lt;br&amp;gt;valence=0.5'/>\n   <text x='392.76' y='67.62' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>popularity<\/text>\n   <text x='448.28' y='107.39' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>acousticness<\/text>\n   <text x='481.04' y='174.31' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>danceability<\/text>\n   <text x='469.59' y='247.13' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>duration_ms<\/text>\n   <text x='432.18' y='302.72' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>energy<\/text>\n   <text x='341.79' y='323.45' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>instrumentalness<\/text>\n   <text x='288.57' y='302.72' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>liveness<\/text>\n   <text x='238.68' y='247.13' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>loudness<\/text>\n   <text x='221.36' y='174.31' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>speechiness<\/text>\n   <text x='264.15' y='107.39' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>tempo<\/text>\n   <text x='323.1' y='67.62' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>valence<\/text>\n  <\/g>\n  <g clip-path='url(#svg_20e0781b_0982_4ede_ac97_71ce36a6226c_c1)'>\n   <text x='212.82' y='167.06' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>0.2<\/text>\n   <text x='212.82' y='141.05' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>0.4<\/text>\n   <text x='212.82' y='115.04' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>0.6<\/text>\n   <text x='212.82' y='89.02' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>0.8<\/text>\n   <polyline points='227.25,163.91 229.99,163.91' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='227.25,137.90 229.99,137.90' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='227.25,111.89 229.99,111.89' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='227.25,85.87 229.99,85.87' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <rect x='303.67' y='5.48' width='142.77' height='28.24' fill='#FFFFFF' fill-opacity='1' stroke='none'/>\n   <text x='309.15' y='23.54' font-size='8.25pt' font-family='Arial'>cluster<\/text>\n   <rect x='347.03' y='10.96' width='17.28' height='17.28' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\n   <rect x='347.74' y='11.67' width='15.86' height='15.86' fill='#F8766D' fill-opacity='0.3' stroke='#F8766D' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='miter' stroke-linecap='butt'/>\n   <circle cx='355.67' cy='19.6' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round'/>\n   <rect x='380.17' y='10.96' width='17.28' height='17.28' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\n   <rect x='380.88' y='11.67' width='15.86' height='15.86' fill='#00BA38' fill-opacity='0.3' stroke='#00BA38' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='miter' stroke-linecap='butt'/>\n   <circle cx='388.81' cy='19.6' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round'/>\n   <rect x='413.3' y='10.96' width='17.28' height='17.28' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\n   <rect x='414.01' y='11.67' width='15.86' height='15.86' fill='#619CFF' fill-opacity='0.3' stroke='#619CFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='miter' stroke-linecap='butt'/>\n   <circle cx='421.94' cy='19.6' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round'/>\n   <text x='369.79' y='22.75' font-size='6.6pt' font-family='Arial'>1<\/text>\n   <text x='402.93' y='22.75' font-size='6.6pt' font-family='Arial'>2<\/text>\n   <text x='436.06' y='22.75' font-size='6.6pt' font-family='Arial'>3<\/text>\n  <\/g>\n <\/g>\n<\/svg>","js":null,"uid":"svg_20e0781b_0982_4ede_ac97_71ce36a6226c","ratio":2,"settings":{"tooltip":{"css":".tooltip_SVGID_ { background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px; ; position:absolute;pointer-events:none;z-index:999;}","placement":"container","opacity":0.75,"offx":10,"offy":0,"use_cursor_pos":true,"use_fill":false,"use_stroke":false,"delay_over":200,"delay_out":500},"hover":{"css":".hover_data_SVGID_ { r:4px;cursor:pointer;stroke-width:6px; }","reactive":false,"nearest_distance":null},"hover_inv":{"css":""},"hover_key":{"css":".hover_key_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\ntext.hover_key_SVGID_ { stroke:none;fill:orange; }\ncircle.hover_key_SVGID_ { fill:orange;stroke:black; }\nline.hover_key_SVGID_, polyline.hover_key_SVGID_ { fill:none;stroke:orange; }\nrect.hover_key_SVGID_, polygon.hover_key_SVGID_, path.hover_key_SVGID_ { fill:orange;stroke:none; }\nimage.hover_key_SVGID_ { stroke:orange; }","reactive":true},"hover_theme":{"css":".hover_theme_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\ntext.hover_theme_SVGID_ { stroke:none;fill:orange; }\ncircle.hover_theme_SVGID_ { fill:orange;stroke:black; }\nline.hover_theme_SVGID_, polyline.hover_theme_SVGID_ { fill:none;stroke:orange; }\nrect.hover_theme_SVGID_, polygon.hover_theme_SVGID_, path.hover_theme_SVGID_ { fill:orange;stroke:none; }\nimage.hover_theme_SVGID_ { stroke:orange; }","reactive":true},"select":{"css":".select_data_SVGID_ { fill:#FF3333;stroke:black; }","type":"multiple","only_shiny":true,"selected":[]},"select_inv":{"css":""},"select_key":{"css":".select_key_SVGID_ { fill:red;stroke:black;cursor:pointer; }\ntext.select_key_SVGID_ { stroke:none;fill:red; }\ncircle.select_key_SVGID_ { fill:red;stroke:black; }\nline.select_key_SVGID_, polyline.select_key_SVGID_ { fill:none;stroke:red; }\nrect.select_key_SVGID_, polygon.select_key_SVGID_, path.select_key_SVGID_ { fill:red;stroke:none; }\nimage.select_key_SVGID_ { stroke:red; }","type":"single","only_shiny":true,"selected":[]},"select_theme":{"css":".select_theme_SVGID_ { fill:red;stroke:black;cursor:pointer; }\ntext.select_theme_SVGID_ { stroke:none;fill:red; }\ncircle.select_theme_SVGID_ { fill:red;stroke:black; }\nline.select_theme_SVGID_, polyline.select_theme_SVGID_ { fill:none;stroke:red; }\nrect.select_theme_SVGID_, polygon.select_theme_SVGID_, path.select_theme_SVGID_ { fill:red;stroke:none; }\nimage.select_theme_SVGID_ { stroke:red; }","type":"single","only_shiny":true,"selected":[]},"zoom":{"min":1,"max":10,"duration":300},"toolbar":{"position":"topright","pngname":"diagram","tooltips":null,"hidden":[],"delay_over":200,"delay_out":500},"sizing":{"rescale":true,"width":1}}},"evals":[],"jsHooks":[]}</script>



---
# Cluster 1


```r
df_original$cluster = factor(k$cluster)

df_original %&gt;% 
  filter(cluster == 1) %&gt;% 
  select(track_name) %&gt;% 
  head(10)%&gt;% 
  knitr::kable()
```



|track_name                                                                                                   |
|:------------------------------------------------------------------------------------------------------------|
|Premières recherches (par Paul Ventimila, Lorie Pester, Véronique Jannot, Michèle Laroque &amp; Gérard Lenorman) |
|Les aventures d'Arsène Lupin: 813 - Partie 6                                                                 |
|Diane                                                                                                        |
|Comme minuit sonnait                                                                                         |
|Une journée d'école qui s'achève (par Véronique Jannot)                                                      |
|Quand un artiste - live                                                                                      |
|Dancing with Gene                                                                                            |
|Sketch producteur (suite)                                                                                    |
|L'Âne chargé d'éponges et l'Âne chargé de sel                                                                |
|Le Vilain Petit Canard 2                                                                                     |

---
# Cluster 2


```r
df_original$cluster = factor(k$cluster)

df_original %&gt;% 
  filter(cluster == 2) %&gt;% 
  select(track_name) %&gt;% 
  head(10)%&gt;% 
  knitr::kable()
```



|track_name                                                                                                                                                                                                       |
|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|Don't Let Me Be Lonely Tonight                                                                                                                                                                                   |
|Dis-moi Monsieur Gordon Cooper                                                                                                                                                                                   |
|Ouverture                                                                                                                                                                                                        |
|Le petit souper aux chandelles                                                                                                                                                                                   |
|Let Me Let Go                                                                                                                                                                                                    |
|Symphony No.4 In E Minor Op.98 : IV. Allegro Energico E Passionato                                                                                                                                               |
|The Hanging (Maverick - Original Motion Picture Score) - Remastered                                                                                                                                              |
|Mangala Aarti                                                                                                                                                                                                    |
|Keys of Love                                                                                                                                                                                                     |
|Tout est possible (par Anggun, Dany Brillant, Garou, Gérard Lenorman, Julie Zenatti, Lisa Angell, Lorie Pester, Natasha St-Pier, Patrick Fiori, Paul Ventimila, Sara Carreira, Veronique Jannot &amp; Vincent Niclo) |


---
# Cluster 3


```r
df_original$cluster = factor(k$cluster)

df_original %&gt;% 
  filter(cluster == 3) %&gt;% 
  select(track_name) %&gt;% 
  head(10) %&gt;% 
  knitr::kable()
```



|track_name                       |
|:--------------------------------|
|C'est beau de faire un Show      |
|Perdu d'avance (par Gad Elmaleh) |
|Helka                            |
|Les bisous des bisounours        |
|J'ai demandé à la lune           |
|Ultra Man 80                     |
|Veunise                          |
|Ladies And Gentlemen             |
|Clic clac cloc                   |
|Monsieur Boum Boum               |

---
# K-means on fewer variables


```r
df2 = df %&gt;% select(loudness, acousticness, energy)

# Apply k-means
k &lt;- kmeans(df2, centers = 3)
df1 = df2
df1$cluster = factor(k$cluster)
```

---
# Plot the radar


```r
# plot the radar
library(ggiraphExtra)
ggRadar(
  data=df1,
  mapping = aes(colours = cluster),
  interactive = T
)
```

<div class="girafe html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-33a3a188ed9fc68d74a9" style="width:720px;height:360px;"></div>
<script type="application/json" data-for="htmlwidget-33a3a188ed9fc68d74a9">{"x":{"html":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' class='ggiraph-svg' role='img' id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4' viewBox='0 0 720 360'>\n <defs id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_defs'>\n  <clipPath id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_c1'>\n   <rect x='0' y='0' width='720' height='360'/>\n  <\/clipPath>\n  <clipPath id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_c2'>\n   <rect x='191.96' y='0' width='336.09' height='360'/>\n  <\/clipPath>\n  <clipPath id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_c3'>\n   <rect x='232.44' y='44.68' width='290.13' height='290.13'/>\n  <\/clipPath>\n <\/defs>\n <g id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_rootg' class='ggiraph-svg-rootg'>\n  <g clip-path='url(#svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_c1)'>\n   <rect x='0' y='0' width='720' height='360' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='0.75' stroke-linejoin='round' stroke-linecap='round' class='ggiraph-svg-bg'/>\n  <\/g>\n  <g clip-path='url(#svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_c2)'>\n   <rect x='191.96' y='0' width='336.09' height='360' fill='#FFFFFF' fill-opacity='1' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='round'/>\n  <\/g>\n  <g clip-path='url(#svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_c3)'>\n   <rect x='232.44' y='44.68' width='290.13' height='290.13' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\n   <polyline points='377.50,189.74 490.57,124.46' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='377.50,189.74 377.50,320.30' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='377.50,189.74 264.44,124.46' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='377.50,168.35 378.86,168.40 380.21,168.53 381.55,168.74 382.87,169.04 384.17,169.42 385.45,169.89 386.69,170.43 387.90,171.05 389.06,171.75 390.18,172.52 391.25,173.36 392.26,174.26 393.21,175.23 394.10,176.26 394.92,177.34 395.67,178.46 396.35,179.64 396.96,180.86 397.48,182.11 397.92,183.39 398.28,184.70 398.56,186.03 398.76,187.37 398.86,188.72 398.89,190.08 398.82,191.44 398.67,192.78 398.43,194.12 398.11,195.44 397.71,196.74 397.23,198.00 396.66,199.24 396.02,200.43 395.31,201.59 394.52,202.69 393.66,203.75 392.74,204.74 391.76,205.68 390.72,206.55 389.63,207.36 388.49,208.09 387.30,208.75 386.08,209.33 384.82,209.84 383.53,210.26 382.21,210.60 380.88,210.86 379.53,211.03 378.18,211.12 376.82,211.12 375.47,211.03 374.12,210.86 372.79,210.60 371.48,210.26 370.19,209.84 368.93,209.33 367.70,208.75 366.52,208.09 365.37,207.36 364.28,206.55 363.24,205.68 362.26,204.74 361.34,203.75 360.48,202.69 359.70,201.59 358.98,200.43 358.34,199.24 357.78,198.00 357.29,196.74 356.89,195.44 356.57,194.12 356.33,192.78 356.18,191.44 356.12,190.08 356.14,188.72 356.25,187.37 356.44,186.03 356.72,184.70 357.08,183.39 357.52,182.11 358.05,180.86 358.65,179.64 359.33,178.46 360.08,177.34 360.90,176.26 361.79,175.23 362.74,174.26 363.75,173.36 364.82,172.52 365.94,171.75 367.10,171.05 368.31,170.43 369.55,169.89 370.83,169.42 372.13,169.04 373.45,168.74 374.79,168.53 376.14,168.40 377.50,168.35' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='377.50,132.06 381.16,132.18 384.80,132.53 388.42,133.11 391.99,133.91 395.50,134.94 398.94,136.20 402.29,137.66 405.54,139.34 408.68,141.22 411.70,143.30 414.57,145.56 417.30,148.00 419.87,150.61 422.27,153.37 424.48,156.28 426.51,159.33 428.34,162.50 429.97,165.78 431.38,169.16 432.58,172.62 433.55,176.14 434.30,179.73 434.82,183.35 435.11,187.00 435.17,190.66 435.00,194.31 434.59,197.95 433.96,201.55 433.09,205.11 432.01,208.60 430.70,212.02 429.18,215.35 427.45,218.58 425.52,221.69 423.40,224.67 421.09,227.51 418.61,230.20 415.96,232.72 413.15,235.08 410.21,237.25 407.13,239.23 403.93,241.01 400.63,242.58 397.23,243.94 393.75,245.08 390.21,246.00 386.61,246.69 382.98,247.16 379.33,247.39 375.67,247.39 372.02,247.16 368.39,246.69 364.79,246.00 361.25,245.08 357.77,243.94 354.38,242.58 351.07,241.01 347.87,239.23 344.80,237.25 341.85,235.08 339.04,232.72 336.40,230.20 333.91,227.51 331.60,224.67 329.48,221.69 327.55,218.58 325.82,215.35 324.30,212.02 323.00,208.60 321.91,205.11 321.05,201.55 320.41,197.95 320.01,194.31 319.83,190.66 319.89,187.00 320.18,183.35 320.70,179.73 321.45,176.14 322.43,172.62 323.62,169.16 325.04,165.78 326.66,162.50 328.49,159.33 330.52,156.28 332.74,153.37 335.13,150.61 337.70,148.00 340.43,145.56 343.30,143.30 346.32,141.22 349.46,139.34 352.71,137.66 356.07,136.20 359.50,134.94 363.02,133.91 366.59,133.11 370.20,132.53 373.84,132.18 377.50,132.06' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='377.50,95.77 383.46,95.96 389.40,96.53 395.28,97.47 401.10,98.79 406.82,100.47 412.42,102.51 417.89,104.90 423.19,107.63 428.30,110.69 433.21,114.07 437.90,117.76 442.35,121.73 446.53,125.98 450.43,130.49 454.04,135.23 457.35,140.20 460.33,145.36 462.98,150.71 465.28,156.21 467.23,161.84 468.82,167.59 470.04,173.42 470.89,179.33 471.36,185.27 471.46,191.23 471.17,197.19 470.51,203.11 469.48,208.99 468.07,214.78 466.30,220.47 464.17,226.04 461.69,231.47 458.88,236.72 455.73,241.79 452.28,246.65 448.52,251.28 444.47,255.66 440.16,259.77 435.59,263.60 430.79,267.14 425.77,270.36 420.56,273.26 415.18,275.82 409.64,278.04 403.97,279.90 398.20,281.40 392.35,282.53 386.43,283.28 380.48,283.66 374.52,283.66 368.57,283.28 362.65,282.53 356.80,281.40 351.03,279.90 345.36,278.04 339.83,275.82 334.44,273.26 329.23,270.36 324.22,267.14 319.42,263.60 314.85,259.77 310.53,255.66 306.49,251.28 302.73,246.65 299.27,241.79 296.12,236.72 293.31,231.47 290.83,226.04 288.70,220.47 286.93,214.78 285.53,208.99 284.49,203.11 283.83,197.19 283.55,191.23 283.64,185.27 284.11,179.33 284.96,173.42 286.18,167.59 287.77,161.84 289.72,156.21 292.03,150.71 294.67,145.36 297.66,140.20 300.96,135.23 304.57,130.49 308.47,125.98 312.66,121.73 317.10,117.76 321.79,114.07 326.70,110.69 331.82,107.63 337.11,104.90 342.58,102.51 348.18,100.47 353.90,98.79 359.72,97.47 365.61,96.53 371.54,95.96 377.50,95.77' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='377.50,59.18 385.78,59.45 394.03,60.23 402.21,61.54 410.29,63.37 418.24,65.70 426.02,68.54 433.61,71.86 440.98,75.65 448.09,79.91 454.91,84.61 461.42,89.73 467.60,95.25 473.41,101.16 478.83,107.42 483.85,114.01 488.44,120.91 492.58,128.08 496.26,135.51 499.46,143.15 502.17,150.98 504.38,158.96 506.07,167.07 507.25,175.27 507.91,183.53 508.04,191.81 507.65,200.09 506.73,208.32 505.29,216.48 503.34,224.53 500.88,232.44 497.92,240.18 494.48,247.72 490.57,255.02 486.20,262.06 481.39,268.81 476.17,275.24 470.55,281.32 464.55,287.04 458.21,292.37 451.53,297.28 444.57,301.76 437.33,305.78 429.85,309.34 422.15,312.42 414.28,315.01 406.26,317.09 398.13,318.66 389.91,319.71 381.64,320.23 373.36,320.23 365.09,319.71 356.87,318.66 348.74,317.09 340.72,315.01 332.85,312.42 325.16,309.34 317.68,305.78 310.44,301.76 303.47,297.28 296.80,292.37 290.45,287.04 284.45,281.32 278.83,275.24 273.61,268.81 268.80,262.06 264.44,255.02 260.52,247.72 257.08,240.18 254.12,232.44 251.66,224.53 249.71,216.48 248.27,208.32 247.35,200.09 246.96,191.81 247.09,183.53 247.75,175.27 248.93,167.07 250.62,158.96 252.83,150.98 255.54,143.15 258.74,135.51 262.42,128.08 266.56,120.91 271.15,114.01 276.17,107.42 281.60,101.16 287.41,95.25 293.58,89.73 300.09,84.61 306.92,79.91 314.02,75.65 321.39,71.86 328.98,68.54 336.76,65.70 344.71,63.37 352.79,61.54 360.97,60.23 369.22,59.45 377.50,59.18' fill='none' stroke='#FFFFFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polygon id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e1' points='435.56,156.22 377.50,305.79 372.71,186.97' fill='#F8766D' fill-opacity='0.3' stroke='#F8766D' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='cluster=1'/>\n   <polygon id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e2' points='468.32,137.30 377.50,189.74 296.61,143.04' fill='#00BA38' fill-opacity='0.3' stroke='#00BA38' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='cluster=2'/>\n   <polygon id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e3' points='458.94,142.72 377.50,261.18 331.51,163.19' fill='#619CFF' fill-opacity='0.3' stroke='#619CFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt' title='cluster=3'/>\n   <circle id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e4' cx='435.56' cy='156.22' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='1' title='cluster=1&amp;lt;br&amp;gt;loudness=0.6'/>\n   <circle id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e5' cx='377.5' cy='305.79' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='2' title='cluster=1&amp;lt;br&amp;gt;acousticness=0.9'/>\n   <circle id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e6' cx='372.71' cy='186.97' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='3' title='cluster=1&amp;lt;br&amp;gt;energy=0.1'/>\n   <circle id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e7' cx='468.32' cy='137.3' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='4' title='cluster=2&amp;lt;br&amp;gt;loudness=0.8'/>\n   <circle id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e8' cx='377.5' cy='189.74' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='5' title='cluster=2&amp;lt;br&amp;gt;acousticness=0.1'/>\n   <circle id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e9' cx='296.61' cy='143.04' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='6' title='cluster=2&amp;lt;br&amp;gt;energy=0.7'/>\n   <circle id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e10' cx='458.94' cy='142.72' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='7' title='cluster=3&amp;lt;br&amp;gt;loudness=0.8'/>\n   <circle id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e11' cx='377.5' cy='261.18' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='8' title='cluster=3&amp;lt;br&amp;gt;acousticness=0.6'/>\n   <circle id='svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_e12' cx='331.51' cy='163.19' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round' data-id='9' title='cluster=3&amp;lt;br&amp;gt;energy=0.5'/>\n   <text x='472.95' y='127.61' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>loudness<\/text>\n   <text x='352.06' y='323.45' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>acousticness<\/text>\n   <text x='250.98' y='127.61' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>energy<\/text>\n  <\/g>\n  <g clip-path='url(#svg_82515c1d_6bc3_4fb3_a18c_884986b58da4_c1)'>\n   <text x='210.37' y='171.5' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>0.25<\/text>\n   <text x='210.37' y='135.21' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>0.50<\/text>\n   <text x='210.37' y='98.92' font-size='6.6pt' font-family='Arial' fill='#4D4D4D' fill-opacity='1'>0.75<\/text>\n   <polyline points='229.70,168.35 232.44,168.35' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='229.70,132.06 232.44,132.06' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <polyline points='229.70,95.77 232.44,95.77' fill='none' stroke='#333333' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='round' stroke-linecap='butt'/>\n   <rect x='306.12' y='5.48' width='142.77' height='28.24' fill='#FFFFFF' fill-opacity='1' stroke='none'/>\n   <text x='311.6' y='23.54' font-size='8.25pt' font-family='Arial'>cluster<\/text>\n   <rect x='349.48' y='10.96' width='17.28' height='17.28' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\n   <rect x='350.19' y='11.67' width='15.86' height='15.86' fill='#F8766D' fill-opacity='0.3' stroke='#F8766D' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='miter' stroke-linecap='butt'/>\n   <circle cx='358.12' cy='19.6' r='2.67pt' fill='#F8766D' fill-opacity='1' stroke='#F8766D' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round'/>\n   <rect x='382.62' y='10.96' width='17.28' height='17.28' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\n   <rect x='383.33' y='11.67' width='15.86' height='15.86' fill='#00BA38' fill-opacity='0.3' stroke='#00BA38' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='miter' stroke-linecap='butt'/>\n   <circle cx='391.26' cy='19.6' r='2.67pt' fill='#00BA38' fill-opacity='1' stroke='#00BA38' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round'/>\n   <rect x='415.75' y='10.96' width='17.28' height='17.28' fill='#EBEBEB' fill-opacity='1' stroke='none'/>\n   <rect x='416.46' y='11.67' width='15.86' height='15.86' fill='#619CFF' fill-opacity='0.3' stroke='#619CFF' stroke-opacity='1' stroke-width='1.07' stroke-linejoin='miter' stroke-linecap='butt'/>\n   <circle cx='424.39' cy='19.6' r='2.67pt' fill='#619CFF' fill-opacity='1' stroke='#619CFF' stroke-opacity='1' stroke-width='0.71' stroke-linejoin='round' stroke-linecap='round'/>\n   <text x='372.24' y='22.75' font-size='6.6pt' font-family='Arial'>1<\/text>\n   <text x='405.38' y='22.75' font-size='6.6pt' font-family='Arial'>2<\/text>\n   <text x='438.51' y='22.75' font-size='6.6pt' font-family='Arial'>3<\/text>\n  <\/g>\n <\/g>\n<\/svg>","js":null,"uid":"svg_82515c1d_6bc3_4fb3_a18c_884986b58da4","ratio":2,"settings":{"tooltip":{"css":".tooltip_SVGID_ { background-color:white;font-style:italic;padding:10px;border-radius:10px 20px 10px 20px; ; position:absolute;pointer-events:none;z-index:999;}","placement":"container","opacity":0.75,"offx":10,"offy":0,"use_cursor_pos":true,"use_fill":false,"use_stroke":false,"delay_over":200,"delay_out":500},"hover":{"css":".hover_data_SVGID_ { r:4px;cursor:pointer;stroke-width:6px; }","reactive":false,"nearest_distance":null},"hover_inv":{"css":""},"hover_key":{"css":".hover_key_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\ntext.hover_key_SVGID_ { stroke:none;fill:orange; }\ncircle.hover_key_SVGID_ { fill:orange;stroke:black; }\nline.hover_key_SVGID_, polyline.hover_key_SVGID_ { fill:none;stroke:orange; }\nrect.hover_key_SVGID_, polygon.hover_key_SVGID_, path.hover_key_SVGID_ { fill:orange;stroke:none; }\nimage.hover_key_SVGID_ { stroke:orange; }","reactive":true},"hover_theme":{"css":".hover_theme_SVGID_ { fill:orange;stroke:black;cursor:pointer; }\ntext.hover_theme_SVGID_ { stroke:none;fill:orange; }\ncircle.hover_theme_SVGID_ { fill:orange;stroke:black; }\nline.hover_theme_SVGID_, polyline.hover_theme_SVGID_ { fill:none;stroke:orange; }\nrect.hover_theme_SVGID_, polygon.hover_theme_SVGID_, path.hover_theme_SVGID_ { fill:orange;stroke:none; }\nimage.hover_theme_SVGID_ { stroke:orange; }","reactive":true},"select":{"css":".select_data_SVGID_ { fill:#FF3333;stroke:black; }","type":"multiple","only_shiny":true,"selected":[]},"select_inv":{"css":""},"select_key":{"css":".select_key_SVGID_ { fill:red;stroke:black;cursor:pointer; }\ntext.select_key_SVGID_ { stroke:none;fill:red; }\ncircle.select_key_SVGID_ { fill:red;stroke:black; }\nline.select_key_SVGID_, polyline.select_key_SVGID_ { fill:none;stroke:red; }\nrect.select_key_SVGID_, polygon.select_key_SVGID_, path.select_key_SVGID_ { fill:red;stroke:none; }\nimage.select_key_SVGID_ { stroke:red; }","type":"single","only_shiny":true,"selected":[]},"select_theme":{"css":".select_theme_SVGID_ { fill:red;stroke:black;cursor:pointer; }\ntext.select_theme_SVGID_ { stroke:none;fill:red; }\ncircle.select_theme_SVGID_ { fill:red;stroke:black; }\nline.select_theme_SVGID_, polyline.select_theme_SVGID_ { fill:none;stroke:red; }\nrect.select_theme_SVGID_, polygon.select_theme_SVGID_, path.select_theme_SVGID_ { fill:red;stroke:none; }\nimage.select_theme_SVGID_ { stroke:red; }","type":"single","only_shiny":true,"selected":[]},"zoom":{"min":1,"max":10,"duration":300},"toolbar":{"position":"topright","pngname":"diagram","tooltips":null,"hidden":[],"delay_over":200,"delay_out":500},"sizing":{"rescale":true,"width":1}}},"evals":[],"jsHooks":[]}</script>
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "<div class=\"progress-bar-container\">\n  <div class=\"progress-bar\" style=\"width: calc(%current% / %total% * 100%);\">\n  </div>\n</div>`"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
